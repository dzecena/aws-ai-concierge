openapi: 3.0.0
info:
  title: AWS AI Concierge Tools
  version: 1.0.0
  description: |
    Tools for AWS resource management and monitoring through natural language interactions.
    This API provides endpoints for cost analysis, resource discovery, and security assessment.

servers:
  - url: https://8qev30t0u9.execute-api.us-east-1.amazonaws.com/prod/
    description: AWS API Gateway endpoint

paths:
  /getCostAnalysis:
    post:
      summary: Analyze AWS costs and spending patterns
      description: |
        Retrieve and analyze AWS cost data using Cost Explorer API.
        Supports different time periods, granularities, and grouping options.
      operationId: getCostAnalysis
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                time_period:
                  type: string
                  enum: ["DAILY", "MONTHLY", "YEARLY"]
                  description: Time period for cost analysis
                  default: "MONTHLY"
                granularity:
                  type: string
                  enum: ["DAILY", "MONTHLY"]
                  description: Data point granularity
                  default: "DAILY"
                group_by:
                  type: string
                  enum: ["SERVICE", "REGION", "USAGE_TYPE", "INSTANCE_TYPE"]
                  description: How to group cost data
                  default: "SERVICE"
              required: ["time_period"]
            examples:
              monthly_by_service:
                summary: Monthly costs grouped by service
                value:
                  time_period: "MONTHLY"
                  granularity: "DAILY"
                  group_by: "SERVICE"
              yearly_by_region:
                summary: Yearly costs grouped by region
                value:
                  time_period: "YEARLY"
                  granularity: "MONTHLY"
                  group_by: "REGION"
      responses:
        '200':
          description: Cost analysis results
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_cost:
                    type: number
                    description: Total cost for the specified period
                  currency:
                    type: string
                    description: Currency code (e.g., USD)
                  time_period:
                    type: string
                    description: Time period analyzed
                  group_by:
                    type: string
                    description: Grouping method used
                  start_date:
                    type: string
                    format: date
                    description: Analysis start date
                  end_date:
                    type: string
                    format: date
                    description: Analysis end date
                  breakdown:
                    type: array
                    description: Cost breakdown by grouping
                    items:
                      type: object
                      properties:
                        service_name:
                          type: string
                        cost:
                          type: number
                        usage_quantity:
                          type: number
                        usage_unit:
                          type: string
                        percentage:
                          type: number
                  daily_costs:
                    type: array
                    description: Daily cost data for trend analysis
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                          format: date
                        cost:
                          type: number
                  cost_trend:
                    type: object
                    description: Cost trend analysis
                    properties:
                      trend:
                        type: string
                        enum: ["increasing", "decreasing", "stable", "insufficient_data", "no_baseline"]
                      change_percentage:
                        type: number
                  optimization_insights:
                    type: array
                    description: Cost optimization recommendations
                    items:
                      type: string
                  analysis_date:
                    type: string
                    format: date-time
                    description: When the analysis was performed

  /idle-resources:
    post:
      summary: Identify idle or underutilized resources
      description: |
        Analyze EC2 instances for low CPU utilization over a specified period.
        Provides potential cost savings estimates for idle resources.
      operationId: getIdleResources
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                region:
                  type: string
                  description: AWS region to analyze
                  default: "us-east-1"
                cpu_threshold:
                  type: number
                  minimum: 0
                  maximum: 100
                  description: CPU utilization threshold percentage
                  default: 5.0
                days:
                  type: integer
                  minimum: 1
                  maximum: 30
                  description: Number of days to analyze
                  default: 7
              required: ["region"]
            examples:
              basic_idle_check:
                summary: Basic idle resource check
                value:
                  region: "us-east-1"
                  cpu_threshold: 5.0
                  days: 7
              strict_idle_check:
                summary: Strict idle resource check
                value:
                  region: "us-west-2"
                  cpu_threshold: 2.0
                  days: 14
      responses:
        '200':
          description: List of idle resources with potential savings
          content:
            application/json:
              schema:
                type: object
                properties:
                  region:
                    type: string
                  analysis_period_days:
                    type: integer
                  cpu_threshold_percent:
                    type: number
                  total_instances_analyzed:
                    type: integer
                  idle_instances:
                    type: array
                    items:
                      type: object
                      properties:
                        instance_id:
                          type: string
                        instance_type:
                          type: string
                        metrics:
                          type: object
                          properties:
                            average_cpu_utilization:
                              type: number
                            max_cpu_utilization:
                              type: number
                            average_network_in:
                              type: number
                            average_network_out:
                              type: number
                            data_points:
                              type: integer
                        launch_time:
                          type: string
                          format: date-time
                        estimated_monthly_cost:
                          type: number
                        potential_monthly_savings:
                          type: number
                        optimization_recommendation:
                          type: string
                          enum: ["terminate", "downsize_significantly", "downsize", "consider_burstable", "monitor"]
                        confidence_level:
                          type: string
                          enum: ["low", "medium", "high"]
                        tags:
                          type: object
                        vpc_id:
                          type: string
                        subnet_id:
                          type: string
                        availability_zone:
                          type: string
                  total_idle_instances:
                    type: integer
                  potential_monthly_savings:
                    type: number
                  optimization_insights:
                    type: array
                    items:
                      type: string
                  currency:
                    type: string
                  analysis_date:
                    type: string
                    format: date-time

  /resource-inventory:
    post:
      summary: Get inventory of AWS resources
      description: |
        Retrieve comprehensive inventory of AWS resources across different types.
        Supports EC2, S3, RDS, Lambda, or all resource types.
      operationId: getResourceInventory
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                resource_type:
                  type: string
                  enum: ["EC2", "S3", "RDS", "LAMBDA", "ALL"]
                  description: Type of resources to list
                  default: "ALL"
                region:
                  type: string
                  description: AWS region to query
                  default: "us-east-1"
              required: ["resource_type", "region"]
            examples:
              all_resources:
                summary: All resources in region
                value:
                  resource_type: "ALL"
                  region: "us-east-1"
              ec2_only:
                summary: EC2 instances only
                value:
                  resource_type: "EC2"
                  region: "us-west-2"
      responses:
        '200':
          description: Resource inventory
          content:
            application/json:
              schema:
                type: object
                properties:
                  resource_type:
                    type: string
                  region:
                    type: string
                  resources:
                    type: array
                    items:
                      type: object
                      properties:
                        resource_id:
                          type: string
                        resource_type:
                          type: string
                        name:
                          type: string
                        status:
                          type: string
                        created_date:
                          type: string
                          format: date-time
                        region:
                          type: string
                        availability_zone:
                          type: string
                        tags:
                          type: object
                        metadata:
                          type: object
                          description: Resource-specific metadata
                  total_count:
                    type: integer
                  inventory_date:
                    type: string
                    format: date-time

  /resource-details:
    post:
      summary: Get detailed information about a specific resource
      description: |
        Retrieve comprehensive details about a specific AWS resource including
        configuration, metadata, and optionally health metrics.
      operationId: getResourceDetails
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                resource_id:
                  type: string
                  description: Unique identifier of the resource
                resource_type:
                  type: string
                  enum: ["EC2", "S3", "RDS", "LAMBDA"]
                  description: Type of the resource
                region:
                  type: string
                  description: AWS region where the resource is located
                  default: "us-east-1"
                include_health:
                  type: boolean
                  description: Whether to include health metrics
                  default: true
              required: ["resource_id", "resource_type"]
            examples:
              ec2_instance:
                summary: EC2 instance details
                value:
                  resource_id: "i-1234567890abcdef0"
                  resource_type: "EC2"
                  region: "us-east-1"
                  include_health: true
              s3_bucket:
                summary: S3 bucket details
                value:
                  resource_id: "my-bucket-name"
                  resource_type: "S3"
                  include_health: false
      responses:
        '200':
          description: Detailed resource information
          content:
            application/json:
              schema:
                type: object
                properties:
                  resource_id:
                    type: string
                  resource_type:
                    type: string
                  region:
                    type: string
                  details:
                    type: object
                    description: Resource-specific detailed information
                  retrieved_at:
                    type: string
                    format: date-time

  /resource-health:
    post:
      summary: Get health status and metrics for a resource
      description: |
        Retrieve CloudWatch health metrics and alarm status for a specific resource.
        Provides overall health assessment and detailed metrics.
      operationId: getResourceHealth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                resource_id:
                  type: string
                  description: Unique identifier of the resource
                resource_type:
                  type: string
                  enum: ["EC2", "RDS", "LAMBDA"]
                  description: Type of the resource
                region:
                  type: string
                  description: AWS region where the resource is located
                  default: "us-east-1"
              required: ["resource_id", "resource_type"]
            examples:
              ec2_health:
                summary: EC2 instance health
                value:
                  resource_id: "i-1234567890abcdef0"
                  resource_type: "EC2"
                  region: "us-east-1"
      responses:
        '200':
          description: Resource health status and metrics
          content:
            application/json:
              schema:
                type: object
                properties:
                  resource_id:
                    type: string
                  resource_type:
                    type: string
                  region:
                    type: string
                  overall_status:
                    type: string
                    enum: ["HEALTHY", "WARNING", "UNHEALTHY", "UNKNOWN"]
                  health_metrics:
                    type: object
                    properties:
                      metrics:
                        type: object
                        description: CloudWatch metrics data
                      period_hours:
                        type: integer
                      last_updated:
                        type: string
                        format: date-time
                  alarms:
                    type: array
                    items:
                      type: object
                      properties:
                        alarm_name:
                          type: string
                        state_value:
                          type: string
                          enum: ["OK", "ALARM", "INSUFFICIENT_DATA"]
                        metric_name:
                          type: string
                        threshold:
                          type: number
                  checked_at:
                    type: string
                    format: date-time

  /security-assessment:
    post:
      summary: Perform security assessment of AWS resources
      description: |
        Analyze AWS resources for security vulnerabilities and compliance issues.
        Supports basic and comprehensive assessment modes.
      operationId: getSecurityAssessment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                region:
                  type: string
                  description: AWS region to assess
                  default: "us-east-1"
                assessment_type:
                  type: string
                  enum: ["BASIC", "COMPREHENSIVE"]
                  description: Type of security assessment
                  default: "BASIC"
              required: ["region"]
            examples:
              basic_assessment:
                summary: Basic security assessment
                value:
                  region: "us-east-1"
                  assessment_type: "BASIC"
              comprehensive_assessment:
                summary: Comprehensive security assessment
                value:
                  region: "us-east-1"
                  assessment_type: "COMPREHENSIVE"
      responses:
        '200':
          description: Security assessment results
          content:
            application/json:
              schema:
                type: object
                properties:
                  region:
                    type: string
                  assessment_type:
                    type: string
                  findings:
                    type: array
                    items:
                      type: object
                      properties:
                        finding_id:
                          type: string
                        severity:
                          type: string
                          enum: ["HIGH", "MEDIUM", "LOW"]
                        title:
                          type: string
                        description:
                          type: string
                        resource_id:
                          type: string
                        resource_type:
                          type: string
                        remediation_steps:
                          type: array
                          items:
                            type: string
                  total_findings:
                    type: integer
                  risk_score:
                    type: integer
                    minimum: 0
                    maximum: 100
                    description: Overall risk score (0-100)
                  recommendations:
                    type: array
                    items:
                      type: string
                  assessment_date:
                    type: string
                    format: date-time

  /encryption-status:
    post:
      summary: Check encryption status of storage resources
      description: |
        Analyze encryption status of AWS storage resources including S3 buckets,
        EBS volumes, and RDS instances.
      operationId: checkEncryptionStatus
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                resource_type:
                  type: string
                  enum: ["S3", "EBS", "RDS", "ALL"]
                  description: Type of resources to check
                  default: "ALL"
                region:
                  type: string
                  description: AWS region to check
                  default: "us-east-1"
              required: ["resource_type"]
            examples:
              all_encryption:
                summary: All resource encryption status
                value:
                  resource_type: "ALL"
                  region: "us-east-1"
              s3_only:
                summary: S3 bucket encryption only
                value:
                  resource_type: "S3"
      responses:
        '200':
          description: Encryption status results
          content:
            application/json:
              schema:
                type: object
                properties:
                  resource_type:
                    type: string
                  region:
                    type: string
                  encryption_status:
                    type: array
                    items:
                      type: object
                      properties:
                        resource_id:
                          type: string
                        resource_type:
                          type: string
                        encrypted:
                          type: boolean
                        encryption_type:
                          type: string
                          enum: ["server-side", "ebs", "rds", "none"]
                        encryption_details:
                          type: object
                          description: Encryption configuration details
                  total_resources:
                    type: integer
                  encrypted_resources:
                    type: integer
                  compliance_percentage:
                    type: number
                    minimum: 0
                    maximum: 100
                  check_date:
                    type: string
                    format: date-time

components:
  schemas:
    Error:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          properties:
            message:
              type: string
              description: User-friendly error message
            type:
              type: string
              description: Error type
            severity:
              type: string
              enum: ["error", "warning"]
            retry_suggested:
              type: boolean
            retry_delay_seconds:
              type: integer
            action_required:
              type: string
        metadata:
          type: object
          properties:
            request_id:
              type: string
            timestamp:
              type: string
              format: date-time
            version:
              type: string

  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    Unauthorized:
      description: Insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    ServiceUnavailable:
      description: AWS service temporarily unavailable
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

security: []

tags:
  - name: Cost Analysis
    description: AWS cost analysis and optimization tools
  - name: Resource Management
    description: AWS resource discovery and monitoring tools
  - name: Security Assessment
    description: AWS security analysis and compliance tools